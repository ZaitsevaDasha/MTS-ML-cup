# MTS-ML-cup

Целью проекта было предсказать пол и возраст пользователя, используя его cookie данные. Датасет включал в себя данные о 415317 пользователях и историях их запросов длиной до полугода, для каждого запроса был известен url сайта, время запроса, местоположение пользователя и данные об устройстве, с которого был отправлен запрос

На основании данных была построена матрица «пользователи x сайты», содержащая количество запросов пользователя к каждому сайту. По этой матрицы были построены эмбеддинги с использованием методов ALS, SVD и LDA. 

Также путем аггрегации были созданы следующие признаки:
- статистики по количеству запросов
- количество уникальных значений посещенных сайтов, городов и регионов
- мода по категориальным переменным
- среднее и максимум по цене устройства
- длительность периода активности пользователя
- отношение количества запросов к длительности
- кол-во запросов в среднем за день / месяц
- доли запросов за утро / день / вечер / ночь
- количество дней без запросов

В качестве модели для предсказания пола я использовала блендинг из трех моделей: TabNet, catboost, xgboost, для задачи предсказания возраста был обучен catboost.

### Итоговые метрики

|             | Roc-auc       | F1 score      |
|-------------| ------------- | ------------- |
|  Пол        | 0.86          | 0.77          |

|             | F1 weighted   | F1 macro      |
|-------------| ------------- | ------------- |
|  Возраст    | 0.43          | 0.29          |
